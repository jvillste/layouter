(ns layouter.key-log
  (:require
   [clojure.string :as string]
   [clojure.test :refer [deftest is]]
   [com.stuartsierra.frequencies :as frequencies]
   [layouter.layout :as layout]
   [layouter.text :as text]
   [medley.core :as medley]))

(defn parse-key-log [key-log]
  (->> (string/split key-log #",")
       (remove empty?)
       (map string/trim)
       (map (fn [line]
              (map parse-long (string/split line #" "))))
       (map (fn [[keycode time]]
              {:keycode keycode
               :time time}))))

(def key-log-file-path "/Users/jukka/nitor-src/posti/matching/temp/data/keylog.txt")

(def space-cocoa-key-code 49)
(def back-space-cocoa-key-code 51)
(def second-in-microseconds 1000000)

(defn apply-back-spaces [events]
  (reduce (fn [events event]
            (if (= (:keycode event) back-space-cocoa-key-code)
              (if (empty? events)
                events
                (pop events))
              (conj events event)))
          []
          events))

(deftest test-apply-back-spaces
  (is (= (apply-back-spaces [{:keycode 1}
                             {:keycode 2}
                             {:keycode 3}])

         (apply-back-spaces [{:keycode 1}
                             {:keycode 5}
                             {:keycode 6}
                             {:keycode back-space-cocoa-key-code}
                             {:keycode back-space-cocoa-key-code}
                             {:keycode 2}
                             {:keycode 3}]))))

(defn key-log-to-string [parsed-log minimum-pause-for-inserting-space]
  (->> parsed-log
       (sort-by :time)
       (apply-back-spaces)
       (partition-all 2 1)
       (mapcat (fn [[event following-event]]
                 (if (and following-event
                          (<= minimum-pause-for-inserting-space
                              (- (:time following-event)
                                 (:time event))))
                   [event
                    {:keycode space-cocoa-key-code
                     :time (inc (:time event))}]
                   [event])))
       (map :keycode)
       (map (->> (assoc (layout/layout-to-cocoa-key-code-to-character layout/qwerty)
                        space-cocoa-key-code " "
                        back-space-cocoa-key-code " ")
                 (medley/remove-vals #{"," "." "-" "<"})))
       (string/join "")))

(deftest test-key-log-to-string
  (is (= "ab c"
         (key-log-to-string (let [character-to-cocoa-key-code (layout/layout-to-character-to-cocoa-key-code layout/qwerty)]
                              [{:keycode (character-to-cocoa-key-code "a"), :time 0}
                               {:keycode (character-to-cocoa-key-code "b"), :time 1}
                               {:keycode (character-to-cocoa-key-code "c"), :time 3}])
                            2))))

(defn key-log-to-string-from-file [file-name]
  (-> file-name
      (slurp)
      (parse-key-log)
      (key-log-to-string (* 2 second-in-microseconds))))

(defn key-log-to-words-from-file [file-name]
  (remove #(= 1 (count %))
          (-> (key-log-to-string-from-file file-name)
              (string/split #"\s+"))))

;; TODO: keylogger logs characters that were not typed by me
;; keylogger should also log characters rather than keycodes

(comment

  (-> key-log-file-path
      (slurp)
      (parse-key-log))

  (key-log-to-string-from-file key-log-file-path)

  (text/text-statistics (string/join " " (key-log-to-words-from-file key-log-file-path)))

  (let [key-pair-means (->> (parse-key-log (slurp key-log-file-path))
                            (filter :down?)
                            (partition 2 1)
                            (map (fn [[a b]]
                                   {:from (key-code-to-character (:keycode a))
                                    :to   (key-code-to-character (:keycode b))
                                    :time (- (:time b)
                                             (:time a))}))
                            (remove (fn [key-pair]
                                      (or (= " " (:from key-pair))
                                          (= " " (:to key-pair))
                                          (= nil (:from key-pair))
                                          (= nil (:to key-pair))
                                          (< 1000000 (:time key-pair))
                                          (= (:from key-pair)
                                             (:to key-pair)))))
                            (group-by (juxt :from :to))
                            (medley/map-vals (fn [key-pairs]
                                               (frequencies/mean (frequencies (map :time key-pairs))))))
        mean           (frequencies/mean (frequencies (vals key-pair-means)))]

    (->> (medley/map-vals (fn [value]
                            (float (/ value mean)))
                          key-pair-means)
         (sort-by second)))

  )

(def key-logger-text-statistics '{:name "key log"
                                  :digram-distribution
                                  {("c" "e") 0.001522456229383405,
                                   ("w" "e") 0.002283684344075108,
                                   ("a" "t") 0.01167216442527277,
                                   ("o" "k") 0.003298655163664045,
                                   ("o" "e") 0.001268713524486171,
                                   ("i" "s") 0.01268713524486171,
                                   ("t" "a") 0.0104034509007866,
                                   ("h" "i") 0.002029941639177874,
                                   ("n" "s") 0.005582339507739152,
                                   ("c" "t") 0.003552397868561279,
                                   ("o" "g") 0.001014970819588937,
                                   ("e" "r") 0.01547830499873129,
                                   ("d" "o") 0.004313625983252981,
                                   ("a" "i") 0.008373509261608729,
                                   ("l" "i") 0.005836082212636387,
                                   ("r" "e") 0.01776198934280639,
                                   ("n" "c") 0.001776198934280639,
                                   ("e" "y") 0.002029941639177874,
                                   ("r" "k") 0.001268713524486171,
                                   ("l" "e") 0.008119766556711495,
                                   ("r" "y") 0.004313625983252981,
                                   ("i" "g") 0.003806140573458513,
                                   ("f" "e") 0.002029941639177874,
                                   ("y" "o") 0.001014970819588937,
                                   ("y" "l") 0.001776198934280639,
                                   ("h" "o") 0.002283684344075108,
                                   ("s" "e") 0.01014970819588937,
                                   ("o" "r") 0.007612281146917026,
                                   ("i" "n") 0.02613549860441512,
                                   ("r" "s") 0.00304491245876681,
                                   ("o" "d") 0.005074854097944684,
                                   ("a" "k") 7.612281146917026E-4,
                                   ("e" "p") 0.001522456229383405,
                                   ("e" "l") 0.005328596802841918,
                                   ("a" "d") 0.005836082212636387,
                                   ("t" "h") 0.01420959147424512,
                                   ("b" "y") 0.001014970819588937,
                                   ("s" "p") 0.001776198934280639,
                                   ("j" "a") 0.001776198934280639,
                                   ("s" "o") 0.00304491245876681,
                                   ("t" "ä") 0.002283684344075108,
                                   ("o" "w") 0.005836082212636387,
                                   ("p" "o") 0.005328596802841918,
                                   ("l" "u") 0.001522456229383405,
                                   ("e" "f") 0.005074854097944684,
                                   ("w" "h") 0.002537427048972342,
                                   ("e" "e") 0.005582339507739152,
                                   ("n" "k") 0.005328596802841918,
                                   ("c" "a") 0.003552397868561279,
                                   ("u" "u") 0.001268713524486171,
                                   ("o" "i") 0.00304491245876681,
                                   ("s" "d") 7.612281146917026E-4,
                                   ("t" "i") 0.0111646790154783,
                                   ("g" "i") 0.003298655163664045,
                                   ("b" "r") 0.001268713524486171,
                                   ("u" "e") 0.00304491245876681,
                                   ("s" "t") 0.01598579040852575,
                                   ("i" "r") 0.001014970819588937,
                                   ("f" "r") 0.001014970819588937,
                                   ("i" "l") 0.004313625983252981,
                                   ("t" "o") 0.00913473737630043,
                                   ("t" "y") 0.001014970819588937,
                                   ("g" "q") 0.001522456229383405,
                                   ("m" "e") 0.01319462065465618,
                                   ("s" "f") 7.612281146917026E-4,
                                   ("l" "d") 7.612281146917026E-4,
                                   ("h" "a") 0.01167216442527277,
                                   ("o" "j") 7.612281146917026E-4,
                                   ("n" "d") 0.004567368688150216,
                                   ("c" "i") 0.001268713524486171,
                                   ("s" "c") 0.001522456229383405,
                                   ("d" "a") 0.00304491245876681,
                                   ("t" "l") 0.001268713524486171,
                                   ("s" "u") 0.00913473737630043,
                                   ("h" "e") 0.01217964983506724,
                                   ("r" "t") 0.001776198934280639,
                                   ("a" "m") 0.004567368688150216,
                                   ("a" "g") 0.001268713524486171,
                                   ("i" "o") 0.006851053032225324,
                                   ("i" "i") 0.001522456229383405,
                                   ("w" "i") 0.001522456229383405,
                                   ("a" "a") 0.003806140573458513,
                                   ("ä" "ä") 0.001014970819588937,
                                   ("l" "t") 0.002283684344075108,
                                   ("i" "t") 0.01091093631058107,
                                   ("k" "y") 0.001776198934280639,
                                   ("w" "s") 7.612281146917026E-4,
                                   ("k" "k") 0.001522456229383405,
                                   ("e" "d") 0.005836082212636387,
                                   ("q" "u") 0.002283684344075108,
                                   ("n" "e") 0.005074854097944684,
                                   ("n" "i") 0.002537427048972342,
                                   ("c" "r") 7.612281146917026E-4,
                                   ("u" "r") 0.002029941639177874,
                                   ("e" "a") 0.002029941639177874,
                                   ("e" "n") 0.01091093631058107,
                                   ("i" "k") 0.001014970819588937,
                                   ("b" "e") 0.001014970819588937,
                                   ("e" "x") 0.002537427048972342,
                                   ("m" "a") 0.006851053032225324,
                                   ("y" "b") 0.001014970819588937,
                                   ("f" "s") 0.001268713524486171,
                                   ("o" "l") 0.003298655163664045,
                                   ("r" "i") 0.006089824917533621,
                                   ("i" "a") 0.001776198934280639,
                                   ("n" "v") 0.001268713524486171,
                                   ("n" "g") 0.004567368688150216,
                                   ("i" "p") 0.001522456229383405,
                                   ("e" "m") 0.005836082212636387,
                                   ("a" "u") 7.612281146917026E-4,
                                   ("t" "t") 0.003298655163664045,
                                   ("e" "w") 0.001268713524486171,
                                   ("k" "a") 0.001776198934280639,
                                   ("u" "k") 7.612281146917026E-4,
                                   ("t" "r") 0.006089824917533621,
                                   ("n" "o") 0.01192590713017001,
                                   ("a" "v") 0.00304491245876681,
                                   ("o" "n") 0.01268713524486171,
                                   ("w" "o") 0.001776198934280639,
                                   ("u" "m") 0.007104795737122558,
                                   ("a" "l") 0.00304491245876681,
                                   ("n" "m") 7.612281146917026E-4,
                                   ("e" "v") 0.005328596802841918,
                                   ("e" "k") 7.612281146917026E-4,
                                   ("c" "h") 0.002791169753869576,
                                   ("t" "n") 0.001776198934280639,
                                   ("o" "s") 0.006343567622430855,
                                   ("b" "h") 7.612281146917026E-4,
                                   ("p" "b") 0.001014970819588937,
                                   ("a" "s") 0.007104795737122558,
                                   ("p" "l") 0.00304491245876681,
                                   ("f" "a") 0.001014970819588937,
                                   ("o" "t") 0.006597310327328089,
                                   ("i" "v") 7.612281146917026E-4,
                                   ("d" "d") 0.002537427048972342,
                                   ("o" "p") 0.001268713524486171,
                                   ("r" "o") 0.005074854097944684,
                                   ("m" "o") 0.005582339507739152,
                                   ("a" "n") 0.008627251966505963,
                                   ("n" "p") 0.003298655163664045,
                                   ("m" "i") 0.003806140573458513,
                                   ("n" "n") 0.006343567622430855,
                                   ("p" "e") 0.001776198934280639,
                                   ("s" "y") 7.612281146917026E-4,
                                   ("k" "i") 0.002537427048972342,
                                   ("y" "m") 7.612281146917026E-4,
                                   ("b" "c") 0.001014970819588937,
                                   ("u" "l") 0.00304491245876681,
                                   ("r" "r") 7.612281146917026E-4,
                                   ("n" "t") 0.009388480081197666,
                                   ("f" "u") 0.001268713524486171,
                                   ("g" "e") 0.002283684344075108,
                                   ("e" "h") 7.612281146917026E-4,
                                   ("l" "l") 0.009388480081197666,
                                   ("u" "t") 0.00304491245876681,
                                   ("z" "i") 7.612281146917026E-4,
                                   ("r" "a") 0.003806140573458513,
                                   ("n" "u") 0.002029941639177874,
                                   ("h" "d") 0.001014970819588937,
                                   ("p" "n") 0.001014970819588937,
                                   ("c" "o") 0.006851053032225324,
                                   ("l" "a") 0.005582339507739152,
                                   ("t" "s") 0.004059883278355747,
                                   ("p" "a") 0.003806140573458513,
                                   ("v" "a") 0.002283684344075108,
                                   ("k" "s") 0.002283684344075108,
                                   ("w" "n") 0.002029941639177874,
                                   ("e" "b") 0.001014970819588937,
                                   ("b" "l") 0.00304491245876681,
                                   ("p" "r") 0.00482111139304745,
                                   ("t" "u") 0.002283684344075108,
                                   ("u" "s") 0.006089824917533621,
                                   ("o" "b") 0.001014970819588937,
                                   ("r" "m") 7.612281146917026E-4,
                                   ("e" "s") 0.01573204770362852,
                                   ("b" "s") 0.001268713524486171,
                                   ("k" "o") 0.001776198934280639,
                                   ("t" "e") 0.01573204770362852,
                                   ("s" "g") 0.002283684344075108,
                                   ("s" "k") 7.612281146917026E-4,
                                   ("a" "c") 0.005328596802841918,
                                   ("s" "s") 0.007104795737122558,
                                   ("p" "p") 0.008373509261608729,
                                   ("p" "f") 0.005582339507739152,
                                   ("k" "e") 0.005582339507739152,
                                   ("u" "n") 0.006597310327328089,
                                   ("i" "e") 0.004059883278355747,
                                   ("k" "n") 0.002029941639177874,
                                   ("d" "e") 0.0111646790154783,
                                   ("v" "i") 0.003552397868561279,
                                   ("j" "o") 0.001522456229383405,
                                   ("m" "p") 0.002029941639177874,
                                   ("s" "n") 0.001268713524486171,
                                   ("r" "n") 0.001014970819588937,
                                   ("v" "e") 0.006089824917533621,
                                   ("c" "k") 0.001268713524486171,
                                   ("l" "y") 0.00304491245876681,
                                   ("o" "u") 0.00482111139304745,
                                   ("n" "y") 7.612281146917026E-4,
                                   ("p" "u") 0.002791169753869576,
                                   ("c" "c") 0.00304491245876681,
                                   ("a" "b") 0.001776198934280639,
                                   ("b" "t") 0.001014970819588937,
                                   ("s" "i") 0.01167216442527277,
                                   ("i" "x") 0.002029941639177874,
                                   ("s" "h") 0.001268713524486171,
                                   ("r" "u") 0.001014970819588937,
                                   ("o" "m") 0.001268713524486171,
                                   ("m" "b") 7.612281146917026E-4,
                                   ("f" "i") 0.005582339507739152,
                                   ("u" "d") 7.612281146917026E-4,
                                   ("f" "o") 0.002537427048972342,
                                   ("m" "u") 0.001522456229383405,
                                   ("n" "l") 7.612281146917026E-4,
                                   ("m" "m") 0.006597310327328089,
                                   ("a" "p") 0.005582339507739152,
                                   ("i" "d") 0.002791169753869576,
                                   ("b" "u") 0.002283684344075108,
                                   ("l" "ä") 0.001522456229383405,
                                   ("b" "b") 0.003298655163664045,
                                   ("j" "n") 0.001014970819588937,
                                   ("k" "u") 0.001268713524486171,
                                   ("l" "o") 0.00304491245876681,
                                   ("b" "i") 0.003806140573458513,
                                   ("s" "a") 0.003298655163664045,
                                   ("p" "i") 0.003806140573458513,
                                   ("j" "u") 0.001014970819588937,
                                   ("j" "p") 0.001268713524486171,
                                   ("i" "u") 7.612281146917026E-4,
                                   ("o" "o") 0.001776198934280639,
                                   ("e" "t") 0.008627251966505963,
                                   ("c" "l") 0.001522456229383405,
                                   ("i" "f") 0.001014970819588937,
                                   ("d" "i") 0.001776198934280639,
                                   ("n" "a") 0.005328596802841918,
                                   ("a" "r") 0.007612281146917026,
                                   ("t" "c") 0.001776198934280639,
                                   ("u" "a") 0.002283684344075108,
                                   ("e" "c") 0.00482111139304745,
                                   ("i" "m") 0.005328596802841918,
                                   ("b" "a") 0.001522456229383405,
                                   ("r" "d") 7.612281146917026E-4,
                                   ("y" "y") 0.001014970819588937},
                                  :trigram-distribution
                                  {("n" "t" "e") 0.004439890710382514,
                                   ("a" "i" "s") 0.004781420765027322,
                                   ("p" "a" "r") 0.00273224043715847,
                                   ("o" "r" "e") 0.00273224043715847,
                                   ("u" "s" "e") 0.004098360655737705,
                                   ("e" "f" "i") 0.00273224043715847,
                                   ("u" "m" "m") 0.006489071038251366,
                                   ("p" "u" "t") 0.002049180327868852,
                                   ("w" "n" "s") 0.002049180327868852,
                                   ("t" "i" "o") 0.003073770491803279,
                                   ("t" "a" "d") 0.003073770491803279,
                                   ("o" "w" "n") 0.00273224043715847,
                                   ("i" "o" "n") 0.005806010928961749,
                                   ("e" "s" "s") 0.004439890710382514,
                                   ("a" "c" "t") 0.00273224043715847,
                                   ("p" "o" "s") 0.002390710382513661,
                                   ("w" "o" "r") 0.002049180327868852,
                                   ("u" "n" "t") 0.002049180327868852,
                                   ("o" "d" "o") 0.002049180327868852,
                                   ("h" "o" "u") 0.002049180327868852,
                                   ("t" "n" "a") 0.002049180327868852,
                                   ("f" "o" "r") 0.002390710382513661,
                                   ("t" "i" "t") 0.001707650273224044,
                                   ("i" "s" "t") 0.001707650273224044,
                                   ("h" "a" "n") 0.00273224043715847,
                                   ("u" "n" "k") 0.003415300546448087,
                                   ("c" "t" "i") 0.002049180327868852,
                                   ("i" "g" "q") 0.002049180327868852,
                                   ("p" "p" "p") 0.002049180327868852,
                                   ("p" "r" "o") 0.00273224043715847,
                                   ("a" "p" "i") 0.003756830601092896,
                                   ("m" "e" "n") 0.00273224043715847,
                                   ("r" "s" "i") 0.002390710382513661,
                                   ("u" "s" "i") 0.00273224043715847,
                                   ("c" "o" "d") 0.003073770491803279,
                                   ("m" "o" "n") 0.001707650273224044,
                                   ("t" "r" "e") 0.004098360655737705,
                                   ("n" "p" "u") 0.001707650273224044,
                                   ("n" "k" "n") 0.002390710382513661,
                                   ("p" "r" "e") 0.003073770491803279,
                                   ("l" "l" "ä") 0.001707650273224044,
                                   ("m" "e" "t") 0.002390710382513661,
                                   ("a" "t" "i") 0.001707650273224044,
                                   ("b" "u" "s") 0.002049180327868852,
                                   ("u" "a" "t") 0.002390710382513661,
                                   ("a" "i" "n") 0.002049180327868852,
                                   ("e" "n" "t") 0.004098360655737705,
                                   ("m" "m" "a") 0.005122950819672131,
                                   ("f" "i" "l") 0.001707650273224044,
                                   ("a" "p" "p") 0.003073770491803279,
                                   ("i" "n" "p") 0.003415300546448087,
                                   ("a" "r" "e") 0.001707650273224044,
                                   ("n" "t" "s") 0.002390710382513661,
                                   ("n" "o" "w") 0.00546448087431694,
                                   ("o" "d" "e") 0.00273224043715847,
                                   ("n" "s" "u") 0.001707650273224044,
                                   ("e" "l" "i") 0.002390710382513661,
                                   ("e" "v" "i") 0.002390710382513661,
                                   ("g" "i" "o") 0.00273224043715847,
                                   ("l" "l" "a") 0.002390710382513661,
                                   ("a" "m" "e") 0.00546448087431694,
                                   ("a" "d" "d") 0.00273224043715847,
                                   ("i" "t" "h") 0.002049180327868852,
                                   ("e" "t" "t") 0.001707650273224044,
                                   ("h" "a" "t") 0.005122950819672131,
                                   ("e" "t" "n") 0.002049180327868852,
                                   ("b" "i" "g") 0.004439890710382514,
                                   ("t" "e" "n") 0.001707650273224044,
                                   ("b" "r" "e") 0.001707650273224044,
                                   ("r" "e" "s") 0.002049180327868852,
                                   ("a" "v" "e") 0.003073770491803279,
                                   ("m" "a" "r") 0.003073770491803279,
                                   ("n" "e" "s") 0.002049180327868852,
                                   ("h" "e" "n") 0.00273224043715847,
                                   ("i" "n" "k") 0.002390710382513661,
                                   ("t" "h" "e") 0.01127049180327869,
                                   ("k" "n" "o") 0.00273224043715847,
                                   ("r" "e" "v") 0.002049180327868852,
                                   ("i" "n" "g") 0.00546448087431694,
                                   ("e" "s" "t") 0.007172131147540984,
                                   ("s" "t" "c") 0.002390710382513661,
                                   ("i" "l" "l") 0.003415300546448087,
                                   ("i" "t" "i") 0.002049180327868852,
                                   ("o" "i" "n") 0.001707650273224044,
                                   ("o" "r" "k") 0.001707650273224044,
                                   ("a" "c" "k") 0.001707650273224044,
                                   ("i" "t" "t") 0.001707650273224044,
                                   ("a" "b" "l") 0.002390710382513661,
                                   ("n" "n" "n") 0.001707650273224044,
                                   ("t" "i" "d") 0.001707650273224044,
                                   ("t" "i" "m") 0.001707650273224044,
                                   ("h" "a" "s") 0.002049180327868852,
                                   ("g" "q" "u") 0.002049180327868852,
                                   ("i" "s" "u") 0.005122950819672131,
                                   ("i" "d" "e") 0.002390710382513661,
                                   ("o" "s" "t") 0.003073770491803279,
                                   ("e" "t" "a") 0.003073770491803279,
                                   ("i" "m" "e") 0.001707650273224044,
                                   ("s" "s" "i") 0.004439890710382514,
                                   ("o" "s" "g") 0.002390710382513661,
                                   ("n" "o" "t") 0.006489071038251366,
                                   ("v" "e" "l") 0.001707650273224044,
                                   ("o" "u" "n") 0.002049180327868852,
                                   ("e" "r" "s") 0.002390710382513661,
                                   ("i" "n" "t") 0.00546448087431694,
                                   ("m" "e" "m") 0.001707650273224044,
                                   ("s" "i" "n") 0.006489071038251366,
                                   ("s" "t" "i") 0.004781420765027322,
                                   ("w" "h" "e") 0.002049180327868852,
                                   ("a" "t" "a") 0.004781420765027322,
                                   ("t" "t" "e") 0.002049180327868852,
                                   ("i" "s" "s") 0.001707650273224044,
                                   ("s" "i" "o") 0.002390710382513661,
                                   ("i" "m" "i") 0.001707650273224044,
                                   ("e" "m" "o") 0.00273224043715847,
                                   ("l" "e" "m") 0.001707650273224044,
                                   ("t" "e" "s") 0.007513661202185792,
                                   ("k" "e" "y") 0.002049180327868852,
                                   ("t" "o" "i") 0.001707650273224044,
                                   ("o" "e" "s") 0.001707650273224044,
                                   ("r" "i" "n") 0.003073770491803279,
                                   ("h" "a" "v") 0.00273224043715847,
                                   ("c" "o" "u") 0.001707650273224044,
                                   ("a" "r" "i") 0.001707650273224044,
                                   ("n" "s" "t") 0.003073770491803279,
                                   ("s" "t" "r") 0.006489071038251366,
                                   ("s" "u" "m") 0.007513661202185792,
                                   ("r" "a" "c") 0.002049180327868852,
                                   ("q" "u" "e") 0.003073770491803279,
                                   ("b" "l" "e") 0.003756830601092896,
                                   ("s" "t" "a") 0.002049180327868852,
                                   ("d" "a" "t") 0.003756830601092896,
                                   ("c" "h" "a") 0.00273224043715847,
                                   ("d" "e" "v") 0.002390710382513661,
                                   ("a" "d" "a") 0.002049180327868852,
                                   ("e" "s" "u") 0.001707650273224044,
                                   ("t" "e" "r") 0.004781420765027322,
                                   ("s" "i" "t") 0.002049180327868852,
                                   ("l" "i" "n") 0.00273224043715847,
                                   ("n" "a" "m") 0.004781420765027322,
                                   ("s" "e" "r") 0.00273224043715847,
                                   ("e" "e" "t") 0.004439890710382514,
                                   ("t" "r" "i") 0.001707650273224044,
                                   ("f" "i" "x") 0.00273224043715847,
                                   ("i" "n" "e") 0.003073770491803279,
                                   ("e" "v" "e") 0.003073770491803279,
                                   ("i" "o" "s") 0.00273224043715847,
                                   ("s" "e" "s") 0.004439890710382514,
                                   ("a" "r" "y") 0.003073770491803279,
                                   ("t" "h" "a") 0.003415300546448087,
                                   ("e" "r" "y") 0.00273224043715847,
                                   ("a" "n" "d") 0.003756830601092896,
                                   ("m" "i" "s") 0.002390710382513661,
                                   ("r" "e" "e") 0.004098360655737705,
                                   ("l" "l" "e") 0.001707650273224044,
                                   ("r" "e" "c") 0.003415300546448087,
                                   ("h" "e" "r") 0.00273224043715847,
                                   ("u" "e" "r") 0.00273224043715847,
                                   ("n" "o" "n") 0.001707650273224044,
                                   ("t" "o" "d") 0.002049180327868852,
                                   ("e" "r" "a") 0.003073770491803279,
                                   ("s" "n" "o") 0.001707650273224044,
                                   ("p" "o" "l") 0.001707650273224044,
                                   ("e" "f" "e") 0.002390710382513661,
                                   ("t" "c" "o") 0.002390710382513661,
                                   ("a" "l" "l") 0.002049180327868852,
                                   ("t" "i" "n") 0.001707650273224044,
                                   ("t" "h" "i") 0.002049180327868852,
                                   ("d" "e" "f") 0.005806010928961749,
                                   ("d" "o" "e") 0.001707650273224044},
                                  :character-distribution
                                  {"d" 0.03189341945902301,
                                   "n" 0.08215583366976181,
                                   "z" 0.00161485668146952,
                                   "w" 0.01231328219620509,
                                   "s" 0.07731126362535325,
                                   "f" 0.01635042389987889,
                                   "e" 0.1102139685102947,
                                   "q" 0.002825999192571659,
                                   "p" 0.04037141703673799,
                                   "j" 0.005853855470327008,
                                   "x" 0.003633427533306419,
                                   "v" 0.01090028259991926,
                                   "a" 0.07771497779572063,
                                   "t" 0.08962454582155834,
                                   "i" 0.08175211949939443,
                                   "k" 0.02018570851836899,
                                   "b" 0.02260799354057327,
                                   "r" 0.04521598708114655,
                                   "y" 0.01635042389987889,
                                   "g" 0.01493742430359306,
                                   "l" 0.03976584578118692,
                                   "u" 0.0361324182478805,
                                   "ä" 0.005853855470327008,
                                   "h" 0.026039563988696,
                                   "ö" 4.037141703673799E-4,
                                   "m" 0.03754541784416633,
                                   "o" 0.06560355268469922,
                                   "c" 0.02482842147759386}})
